<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Man Behind the Tree</title>
    <link rel="icon" type="image/x-icon" href="ice.ico">
    <link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            background: linear-gradient(135deg, #0a0a0a 0%, #1a0a1a 50%, #0a0a0a 100%);
            color: #e0e0e0;
            font-family: 'VT323', monospace;
            font-size: 18px;
            line-height: 1.6;
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }
        .snow {
            position: fixed;
            top: -100px;
            left: 0;
            width: 100%;
            height: 100vh;
            pointer-events: none;
            z-index: 1;
        }
        .snowflake {
            position: absolute;
            color: rgba(255, 255, 255, 0.3);
            user-select: none;
            pointer-events: none;
            font-size: 14px;
            animation: fall linear infinite;
        }
        @keyframes fall {
            0% {
                transform: translateY(-100px) translateX(0px);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) translateX(var(--drift, 0px));
                opacity: 0;
            }
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 2;
        }
        .title {
            text-align: center;
            font-size: 3.5em;
            margin-bottom: 10px;
            text-shadow: 3px 3px 0px #ff0000, -3px -3px 0px #00ffff;
            position: relative;
        }
        .tree-emoji {
            font-size: 1.2em;
            filter: hue-rotate(120deg) brightness(0.8);
        }
        .subtitle {
            text-align: center;
            font-size: 1.2em;
            margin-bottom: 40px;
            color: #888;
            text-shadow: 1px 1px 2px #000;
        }
        .story-content {
            background: rgba(0, 0, 0, 0.7);
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 0 30px rgba(255, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .story-content p {
            margin-bottom: 20px;
            font-size: 1.1em;
            text-shadow: 1px 1px 1px #000;
        }
        .glitch {
            position: relative;
            color: #fff;
            animation: glitch 2s infinite;
        }
        .glitch-emphasis {
            color: #ff4444;
            font-weight: bold;
            text-shadow: 2px 0 #ff0000, -2px 0 #00ffff;
        }
        .glitch-thought {
            color: #ffaa00;
            font-style: italic;
            text-shadow: 1px 1px 3px #000;
        }
        .glitch-memory {
            color: #aa88ff;
            text-shadow: 0 0 5px #aa88ff;
        }
        @keyframes glitch {
            0%, 98% {
                text-shadow: 3px 3px 0px #ff0000, -3px -3px 0px #00ffff;
            }
            1% {
                text-shadow: -3px 3px 0px #ff0000, 3px -3px 0px #00ffff;
            }
            2% {
                text-shadow: 3px -3px 0px #ff0000, -3px 3px 0px #00ffff;
            }
        }
        .cursor-trail {
            position: absolute;
            width: 6px;
            height: 6px;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 50%;
            pointer-events: none;
            animation: fade-out 0.5s ease-out forwards;
            z-index: 1000;
        }
        @keyframes fade-out {
            from {
                opacity: 1;
                transform: scale(1);
            }
            to {
                opacity: 0;
                transform: scale(0);
            }
        }
        .music-controls {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 10px;
            background: rgba(0, 0, 0, 0.8);
            padding: 10px 15px;
            border-radius: 5px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .music-btn {
            background: #222;
            color: #fff;
            border: 1px solid #555;
            padding: 8px 12px;
            border-radius: 3px;
            font-family: 'VT323', monospace;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s;
        }
        .music-btn:hover {
            background: #333;
            border-color: #777;
        }
        .music-btn.playing {
            background: #004400;
            border-color: #00aa00;
            color: #00ff00;
        }
        .volume-slider {
            width: 80px;
            accent-color: #ff4444;
        }
        .volume-label {
            color: #ccc;
            font-size: 12px;
            font-family: 'VT323', monospace;
        }
        .music-info {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.9);
            color: #00ff00;
            padding: 15px;
            border-radius: 5px;
            font-family: 'VT323', monospace;
            font-size: 14px;
            border: 1px solid #00aa00;
            transform: translateX(120%);
            transition: transform 0.5s ease;
            z-index: 1001;
            max-width: 300px;
            position: relative;
            overflow: hidden;
        }
        .music-info.show {
            transform: translateX(0);
        }
        .music-info-scanlines {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: repeating-linear-gradient(
                0deg,
                transparent,
                transparent 2px,
                rgba(0, 255, 0, 0.03) 2px,
                rgba(0, 255, 0, 0.03) 4px
            );
            pointer-events: none;
        }
        .music-info-static {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><filter id="noise"><feTurbulence baseFrequency="0.9" numOctaves="4" stitchTiles[...]');
            pointer-events: none;
            animation: static 0.1s infinite;
        }
        @keyframes static {
            0% { transform: translate(0, 0); }
            10% { transform: translate(-1px, 1px); }
            20% { transform: translate(1px, 0px); }
            30% { transform: translate(0px, -1px); }
            40% { transform: translate(-1px, -1px); }
            50% { transform: translate(1px, 1px); }
            60% { transform: translate(0px, 0px); }
            70% { transform: translate(-1px, 0px); }
            80% { transform: translate(1px, -1px); }
            90% { transform: translate(0px, 1px); }
            100% { transform: translate(0px, 0px); }
        }
        .final-creepy-line {
            display: flex;
            justify-content: center;
            gap: 0.08em;
            margin-top: 16px;
            margin-bottom: 8px;
            font-size: 2.4em;
            font-family: 'VT323', monospace;
            letter-spacing: 0.13em;
            position: relative;
            z-index: 20;
            user-select: none;
        }
        .final-creepy-line .char {
            display: inline-block;
            position: relative;
            transition: 
                color 0.23s cubic-bezier(.5,2,.3,1), 
                filter 0.12s, 
                transform 0.13s cubic-bezier(.5,2,.3,1);
            text-shadow: 1px 0 5px #000, 0 1px 8px #ff0000;
        }
        .final-creepy-line .shake {
            animation: final-creepy-shake 0.38s cubic-bezier(.5,2,.3,1);
        }
        .final-creepy-line .glitch {
            color: #ff0000;
            filter: blur(0.8px) contrast(1.08);
            text-shadow: 
                2px 0 #fff, 
                -2px 0 #00fff2,
                0 0 8px #ff0000;
            animation: final-creepy-glitch 0.38s cubic-bezier(.5,2,.3,1);
        }
        @keyframes final-creepy-shake {
            0% { transform: translate(0,0) skewX(0deg); }
            23% { transform: translate(-2px, 1px) skewX(-2deg); }
            38% { transform: translate(1.5px, -2px) skewX(1deg);}
            63% { transform: translate(-1px, 2.2px) skewX(-3deg);}
            80% { transform: translate(2px, -1.5px) skewX(2deg);}
            100% { transform: translate(0,0) skewX(0deg);}
        }
        @keyframes final-creepy-glitch {
            0% { filter: blur(0.8px) contrast(1.08); color: #ff0000;}
            55% { filter: blur(2.4px) contrast(1.3); color: #fff;}
            85% { filter: blur(2.7px) contrast(1.4); color: #00fff2;}
            100% { filter: blur(0.8px) contrast(1.08); color: #ff0000;}
        }
        .final-creepy-line .wingdings {
            font-family: 'Wingdings', 'Wingdings 1', 'Webdings', 'Symbola', cursive !important;
            letter-spacing: 0.21em;
            color: #c6baff !important;
            filter: contrast(1.1) grayscale(0.45) brightness(1.1);
            text-shadow: 0 0 10px #222, 1.5px 0 6px #fff, 0 1.5px 8px #8e00ff;
            transition: color 0.15s, filter 0.1s;
        }
        .final-creepy-line .whisper {
            opacity: 0.56;
            color: #fffbe8 !important;
            filter: blur(0.7px);
        }
        .final-creepy-line.fading {
            opacity: 0.75;
            filter: blur(1.5px) grayscale(0.15);
            transition: opacity 0.24s, filter 0.2s;
        }
        .final-creepy-line .sr-only {
            position: absolute;
            left: -9999px;
            width: 1px;
            height: 1px;
            overflow: hidden;
        }
        @media (max-width: 768px) {
            .title {
                font-size: 2.5em;
            }
            .container {
                padding: 15px;
            }
            .story-content {
                padding: 20px;
            }
            .music-controls {
                bottom: 10px;
                right: 10px;
                padding: 8px 10px;
            }
        }
    </style>
</head>
<body>
    <div class="snow" id="snow"></div>
    
    <div class="container">
        <h1 class="title glitch"><span class="tree-emoji">🌲</span> "The Man Behind the Tree"</h1>
        <div class="subtitle">POV: Kris | Genre: Psychological Horror | Deltarune Fan Story</div>
        
        <div class="story-content">
            <p><span class="glitch-emphasis">You shouldn't be here.</span></p>
            <p>But your feet are already in the dirt. Knees bent slightly. Hands slack. Bark under your nails. You don't remember walking up to the tree, but here it is. Here you are.</p>
            <p>The air is quiet, except it isn't. Something hums. Or buzzes. Or rings.</p>
            <p>You blink.</p>
            <p><span class="glitch-thought">"There is a man here."</span></p>
            <p>That thought doesn't belong to you. Not really. But it's there, like it's always been there, stapled to the back of your eyes. You're standing in front of the big pine behind the school[...]
            <p><span class="glitch-thought">"There is a man here."</span></p>
            <p>Your hands are cold. One of them is holding something.</p>
            <p><span class="glitch-emphasis">You don't look.</span></p>
            <p><span class="glitch-emphasis">You can't look.</span></p>
            <p>There's bark beneath your fingertips again. You were scratching. You think. Or maybe clawing. There's a small wound. Yours? Hers?</p>
            <p><span class="glitch-memory">You were crying.</span></p>
            <p>No… no. That's not right.</p>
            <p><span class="glitch-memory">She was crying.</span></p>
            <p>Yes. She was. Behind you. In front of you. By the tree. It's hard to say. The sound's long gone, but the echo's still fresh, like steam in winter.</p>
            <p>The grass is bent where she stood. You think it was her. <span class="glitch-memory">Antlers like candle branches. Shoulders curled in.</span> She kept looking at you, but you couldn't [...]
            <p><span class="glitch-emphasis">Or maybe you let go.</span></p>
            <p>You can't stop looking at the tree.</p>
            <p>There's a shape behind it. Not moving. Not breathing. Not—</p>
            <p><span class="glitch">No, wait.</span></p>
            <p><span class="glitch-memory">It was moving. It was breathing.</span></p>
            <p>You don't remember seeing its face. But you remember it having one. You remember the way it pressed against the bark, like it wanted to disappear into it. Like it was listening. Or wait[...]
            <p><span class="glitch-memory">Dess was afraid. She tugged your sleeve.</span> <span class="glitch-emphasis">You didn't move.</span></p>
            <p>You don't remember why you didn't move.</p>
            <p>Maybe you wanted to see what the man would do.</p>
            <p><span class="glitch-emphasis">You don't remember what he did.</span></p>
            <p>Just—</p>
            <p><span class="glitch">Darkness. Like something closing. Like a lid. Like an eye.</span><br>
            And then…</p>
            <p>You were standing alone.</p>
            <p>Your hand was empty. The wind was blowing. The sun was lower than it should've been.<br>
            Your throat was dry and tight.</p>
            <p><span class="glitch-memory">No antlers. No guitar. No laughter.</span><br>
            Just the tree. And you.</p>
            <p><span class="glitch-thought">"Well. There was a man here."</span></p>
            <p>You're still not sure if that means he's gone.</p>
            <p>Or if he's just somewhere else now.</p>
            <p><span class="glitch-emphasis">Behind another tree.</span></p>
            <!-- FINAL CREEPY LINE START -->
            <div class="final-creepy-line" id="finalLine" aria-live="polite">
                <!-- Accessible fallback for screen readers -->
                <span class="sr-only">Behind you.</span>
                <span class="char">B</span>
                <span class="char">e</span>
                <span class="char">h</span>
                <span class="char">i</span>
                <span class="char">n</span>
                <span class="char">d</span>
                <span class="char">&nbsp;</span>
                <span class="char">y</span>
                <span class="char">o</span>
                <span class="char">u</span>
                <span class="char">.</span>
            </div>
            <!-- FINAL CREEPY LINE END -->
        </div>
    </div>

    <!-- Music Player Structure -->
    <audio id="backgroundMusic" loop preload="auto">
        <source src="flashback.ogg" type="audio/ogg">
        <source src="flashback.mp3" type="audio/mpeg">
        Your browser does not support the audio element.
    </audio>

    <div class="music-controls">
        <button id="musicToggle" class="music-btn">♫ Music: OFF</button>
        <input type="range" id="volumeSlider" min="0" max="100" value="30" class="volume-slider">
        <span class="volume-label">Vol</span>
    </div>

    <div class="music-info" id="musicInfo" data-text="♪ i can hear you.... please... help me...: found.ogg">
        ♪ i can hear you.... please... help me...: found.ogg
        <div class="music-info-scanlines"></div>
        <div class="music-info-static"></div>
    </div>

    <script>
        // ==== Final Creepy Line Animation ====
        // "Behind you." => [Wingdings], "Find Her.", "Help Me.", then back, with per-letter shakes and glitch

        // Undertale/DELTARUNE Wingdings mapping for "Behind you."
        // Based on font: https://www.fontspace.com/wingdings-font-f11672 (classic Win95/Undertale style)
        // These are Unicode codepoints that, when shown in Wingdings, look like Undertale's
        // Wingdings text in Undertale for "Behind you." is "⍑𝙹∷⍜∴∷⊑ ⍜⍙." (using the fanmade font, but here we use typical available mappings)
        // For best web compatibility, we'll use the most visually similar Unicode codepoints as in most Undertale fanfics:
        const undertaleWingdingsMap = {
            'B': '\u{25A1}', // □
            'e': '\u{25A0}', // ■
            'h': '\u{25C6}', // ◆
            'i': '\u{25C7}', // ◇
            'n': '\u{25CB}', // ○
            'd': '\u{25CF}', // ●
            ' ': '\u00A0',
            'y': '\u{2605}', // ★
            'o': '\u{2666}', // ♦
            'u': '\u{25B2}', // ▲
            '.': '\u{2022}'  // •
        };
        // For true Undertale flavor, you could use: ['⍑','𝙹','∷','⍜','∴','∷','⊑','⍜','⍙','.']
        // but not all browsers/devices support those.
        // If you want the exact Undertale-style, use the below string for "Behind you."
        const undertaleWingdingsString = [
            '\u2d51', // ⍑
            '\ud835\ude39', // 𝙹
            '\u2237', // ∷
            '\u2d5c', // ⍜
            '\u2234', // ∴
            '\u2237', // ∷
            '\u2291', // ⊑
            '\u00A0',
            '\u2d5c', // ⍜
            '\u2d59', // ⍙
            '\u002e'
        ];
        // We'll use this string for best authenticity, falling back to the previous map if needed.
        function toUndertaleWingdings(char, idx) {
            // Try using the exact string for "Behind you."
            if (typeof undertaleWingdingsString[idx] !== "undefined") {
                return undertaleWingdingsString[idx];
            }
            // Fallback to basic shapes
            return undertaleWingdingsMap[char] || char;
        }

        const finalLine = document.getElementById('finalLine');
        let charSpans = finalLine.querySelectorAll('.char');
        // The three message states:
        const states = [
            { // 0: Normal
                text: "Behind you.",
                mode: "normal"
            },
            { // 1: Wingdings (Undertale style)
                text: "Behind you.",
                mode: "wingdings"
            },
            { // 2: Glitch "Find Her."
                text: "Find Her.",
                mode: "glitch"
            },
            { // 3: Glitch "Help Me."
                text: "Help Me.",
                mode: "glitch"
            }
        ];

        // Track current state
        let currentState = 0;
        let lastSwapTime = Date.now();

        // Helper to update the display
        function updateFinalLine(stateIdx, fade = false) {
            const state = states[stateIdx];
            if (fade) {
                finalLine.classList.add('fading');
            } else {
                finalLine.classList.remove('fading');
            }
            // If text length is different, replace spans
            if (charSpans.length !== state.text.length) {
                finalLine.innerHTML = '<span class="sr-only">' + state.text + '</span>';
                for (let c of state.text) {
                    const span = document.createElement('span');
                    span.className = 'char';
                    span.textContent = c;
                    finalLine.appendChild(span);
                }
                charSpans = finalLine.querySelectorAll('.char');
            } else {
                // Otherwise just update letters
                finalLine.querySelector('.sr-only').textContent = state.text;
                charSpans.forEach((span, i) => {
                    span.textContent = state.text[i];
                });
            }
            // Apply per-letter styles
            const updatedSpans = finalLine.querySelectorAll('.char');
            updatedSpans.forEach((span, i) => {
                span.classList.remove('wingdings', 'glitch', 'shake', 'whisper');
                // Wingdings state
                if (state.mode === 'wingdings') {
                    if (state.text[i] !== ' ') {
                        span.classList.add('wingdings');
                        // Use real Undertale Wingdings
                        span.textContent = toUndertaleWingdings(state.text[i], i);
                    }
                }
                // Glitch state
                if (state.mode === 'glitch') {
                    // Each letter gets shake and glitch
                    if (state.text[i] !== ' ') {
                        span.classList.add('glitch', 'shake');
                        // Sometimes fade a letter for extra effect
                        if (Math.random() > 0.7) span.classList.add('whisper');
                    } else {
                        span.classList.remove('glitch', 'shake', 'whisper');
                    }
                }
            });
        }

        // Animate per-letter jitters randomly in normal and wingdings states
        function jitterFinalLine() {
            const spans = finalLine.querySelectorAll('.char');
            if (currentState === 0 || currentState === 1) {
                spans.forEach(span => {
                    if (Math.random() > 0.91 && span.textContent.trim() !== '') {
                        span.classList.add('shake');
                        setTimeout(() => span.classList.remove('shake'), 140 + Math.random()*120);
                    }
                });
            }
        }

        // Swap states on a timer
        let swapTimer = null;
        function nextFinalState() {
            let delay;
            if (currentState === 0) { // Normal to Wingdings
                currentState = 1;
                delay = 650 + Math.random()*600;
            } else if (currentState === 1) { // Wingdings to Glitch "Find Her."
                currentState = 2;
                delay = 240 + Math.random()*200;
            } else if (currentState === 2) { // "Find Her." to "Help Me."
                currentState = 3;
                delay = 180 + Math.random()*140;
            } else if (currentState === 3) { // "Help Me." to Normal
                currentState = 0;
                delay = 2600 + Math.random()*2000;
            }
            let fade = (currentState === 1 || currentState === 0);
            updateFinalLine(currentState, fade);
            swapTimer = setTimeout(nextFinalState, delay);
        }
        updateFinalLine(0);
        swapTimer = setTimeout(nextFinalState, 2600 + Math.random()*2200);
        setInterval(jitterFinalLine, 68);

        // Create falling snow
        function createSnow() {
            const snow = document.getElementById('snow');
            const snowflakeCount = 80;
            for (let i = 0; i < snowflakeCount; i++) {
                const snowflake = document.createElement('div');
                snowflake.className = 'snowflake';
                const snowflakeTypes = ['❄', '❅', '❆', '*', '·', '✦'];
                snowflake.innerHTML = snowflakeTypes[Math.floor(Math.random() * snowflakeTypes.length)];
                snowflake.style.left = Math.random() * 100 + '%';
                snowflake.style.animationDuration = (Math.random() * 4 + 3) + 's';
                snowflake.style.animationDelay = Math.random() * 5 + 's';
                snowflake.style.setProperty('--drift', (Math.random() - 0.5) * 100 + 'px');
                snow.appendChild(snowflake);
            }
        }

        // Cursor trail effect
        document.addEventListener('mousemove', function(e) {
            if (Math.random() > 0.8) {
                const trail = document.createElement('div');
                trail.className = 'cursor-trail';
                trail.style.left = e.pageX + 'px';
                trail.style.top = e.pageY + 'px';
                document.body.appendChild(trail);
                setTimeout(() => {
                    if (document.body.contains(trail)) {
                        document.body.removeChild(trail);
                    }
                }, 500);
            }
        });

        // Random text corruption
        function corruptText() {
            const textElements = document.querySelectorAll('.story-content p');
            const randomElement = textElements[Math.floor(Math.random() * textElements.length)];
            if (Math.random() > 0.95) {
                const originalHTML = randomElement.innerHTML;
                const textContent = randomElement.textContent;
                const corruptedText = textContent.split('').map(char => {
                    return Math.random() > 0.95 ? '█' : char;
                }).join('');
                randomElement.textContent = corruptedText;
                setTimeout(() => {
                    randomElement.innerHTML = originalHTML;
                }, 100);
            }
        }

        // Glitch/jitter the music-info popup
        function glitchMusicInfo() {
            const musicInfo = document.getElementById('musicInfo');
            if (!musicInfo.classList.contains('show')) return;
            if (Math.random() > 0.8) {
                const dx = (Math.random() - 0.5) * 12;
                const dy = (Math.random() - 0.5) * 10;
                const scale = 1 + (Math.random() - 0.5) * 0.08;
                const rot = (Math.random() - 0.5) * 2.5;
                musicInfo.style.transform = `translateX(0) scale(${scale}) translate(${dx}px,${dy}px) rotate(${rot}deg)`;
            } else {
                musicInfo.style.transform = 'translateX(0)';
            }
            if (Math.random() > 0.93) {
                let txt = musicInfo.getAttribute("data-text");
                const corruptionChars = ['█', '▓', '▒', '░', '҉', 'Ì·', 'Ì¸', 'Ì€', 'Ì'];
                let corrupted = '';
                for (let i = 0; i < txt.length; i++) {
                    if (Math.random() > 0.97) {
                        corrupted += corruptionChars[Math.floor(Math.random()*corruptionChars.length)];
                    } else {
                        corrupted += txt[i];
                    }
                }
                musicInfo.innerHTML = corrupted +
                    '<div class="music-info-scanlines"></div><div class="music-info-static"></div>';
            } else {
                musicInfo.innerHTML = musicInfo.getAttribute("data-text") +
                    '<div class="music-info-scanlines"></div><div class="music-info-static"></div>';
            }
            if (Math.random() > 0.995) {
                try {
                    if (window.AudioContext || window.webkitAudioContext) {
                        let ctx = window._staticCtx || (window._staticCtx = new (window.AudioContext || window.webkitAudioContext)());
                        let buffer = ctx.createBuffer(1, 4096, ctx.sampleRate);
                        let data = buffer.getChannelData(0);
                        for (let i = 0; i < data.length; i++) {
                            data[i] = (Math.random()-0.5) * (Math.random() > 0.98 ? 2 : 0.35);
                        }
                        let src = ctx.createBufferSource();
                        src.buffer = buffer;
                        let gain = ctx.createGain();
                        gain.gain.value = 0.15 + Math.random()*0.08;
                        src.connect(gain).connect(ctx.destination);
                        src.start(0);
                        src.stop(ctx.currentTime + 0.06 + Math.random() * 0.13);
                    }
                } catch (e) {
                    console.log('Static sound failed:', e);
                }
            }
        }

        createSnow();
        setInterval(corruptText, 3000);
        setInterval(glitchMusicInfo, 80);

        // ---- Music system ----
        let musicPlaying = false;
        let userInteracted = false;
        const audio = document.getElementById('backgroundMusic');
        const musicToggle = document.getElementById('musicToggle');
        const volumeSlider = document.getElementById('volumeSlider');
        const musicInfo = document.getElementById('musicInfo');
        audio.volume = 0.3;

        musicToggle.addEventListener('click', function() {
            if (musicPlaying) {
                audio.pause();
                musicToggle.textContent = '♫ Music: OFF';
                musicToggle.classList.remove('playing');
                musicInfo.classList.remove('show');
                musicPlaying = false;
            } else {
                audio.play().then(() => {
                    musicToggle.textContent = '♫ Music: ON';
                    musicToggle.classList.add('playing');
                    musicInfo.classList.add('show');
                    musicInfo.innerHTML = musicInfo.getAttribute("data-text") +
                        '<div class="music-info-scanlines"></div><div class="music-info-static"></div>';
                    musicPlaying = true;
                }).catch(e => {
                    console.log('Audio play failed:', e);
                });
            }
        });

        volumeSlider.addEventListener('input', function() {
            audio.volume = this.value / 100;
        });

        document.addEventListener('click', function() {
            if (!userInteracted && !musicPlaying) {
                userInteracted = true;
                audio.play().then(() => {
                    musicToggle.textContent = '♫ Music: ON';
                    musicToggle.classList.add('playing');
                    musicInfo.classList.add('show');
                    musicInfo.innerHTML = musicInfo.getAttribute("data-text") +
                        '<div class="music-info-scanlines"></div><div class="music-info-static"></div>';
                    musicPlaying = true;
                }).catch(e => {
                    console.log('Auto-play failed:', e);
                });
            }
        }, { once: true });

        audio.addEventListener('play', function() {
            setTimeout(() => {
                musicInfo.classList.remove('show');
            }, 5000);
        });

        audio.addEventListener('error', function(e) {
            musicToggle.textContent = '♫ Music: ERROR';
            console.log('Error loading audio file:', e);
        });

        window.addEventListener('load', function() {
            audio.volume = 0.3;
            audio.play().then(() => {
                musicToggle.textContent = '♫ Music: ON';
                musicToggle.classList.add('playing');
                musicInfo.classList.add('show');
                musicInfo.innerHTML = musicInfo.getAttribute("data-text") +
                    '<div class="music-info-scanlines"></div><div class="music-info-static"></div>';
                musicPlaying = true;
            }).catch(function(error) {
                console.log('Autoplay prevented:', error);
            });
        });
    </script>
</body>
</html>
